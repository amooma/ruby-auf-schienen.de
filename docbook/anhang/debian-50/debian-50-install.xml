<?xml version="1.0" encoding="UTF-8"?>
<section version="5.0" xml:id="ruby-on-rails-install-howto-debian"
         xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:svg="http://www.w3.org/2000/svg"
         xmlns:m="http://www.w3.org/1998/Math/MathML"
         xmlns:html="http://www.w3.org/1999/xhtml"
         xmlns:db="http://docbook.org/ns/docbook">
  <title xml:id="ruby-on-rails-install-howto-debian.title">Installation auf
  Debian 5.0</title>

  <para>Es wird ein frisch installiertes Debian GNU/Linux 5.0 („Lenny“)
  vorausgesetzt. Ein ISO-Image für die Installation finden Sie auf
  <uri>http://www.debian.org/releases/lenny/debian-installer/</uri>. Ich
  empfehle das etwa 160 MByte große Netzinstallations-CD-Image. Eine Debian
  GNU/Linux-Installationsanleitung findet sich unter
  <uri>http://www.debian.org/releases/lenny/i386/</uri>. Ein allgemeines
  Anwenderhandbuch finden Sie unter
  <uri>http://debiananwenderhandbuch.de</uri>.</para>

  <para><important>
      <para>Bitte loggen Sie sich nach der Installation als Benutzer root am
      System ein, und führen Sie alle hier angegebenen Befehle mit diesem
      Benutzer aus.</para>
    </important><note>
      <para>Einige Anwender werden nach der Grundinstallation direkt einen
      SSH-Server installieren wollen, um von ihrem normalen Arbeitsplatz aus
      im Terminal auf dem Server arbeiten zu können. Der Befehl dazu lautet:
      <command>aptitude install ssh</command>. Dann können Sie im Folgenden
      auch wunderbar mit Kopieren und Einsetzen der meisten Befehle arbeiten.
      Ich setze voraus, dass Sie entweder mit der grundsätzlichen Verwendung
      von ssh vertraut sind oder direkt am System selbst arbeiten.</para>
    </note></para>

  <para>Es wird in dieser Anleitung nicht jeder Schritt und jeder Befehl lang
  und breit erklärt. Ich gehe davon aus, das Sie sich mit der Linux
  Kommandozeile so gut auskennen, das die jeweiligen Befehle selbsterklärend
  sind.</para>

  <para>Es versteht sich eigentlich von selbst, dass man auf einem frisch
  installierten System erst einmal sicherstellt, dass die Paketverwaltung die
  aktuellen Paketlisten zur Verfügung hat und das System auf dem neuesten
  Stand ist.<screen>debian:~# <command>aptitude update &amp;&amp; aptitude safe-upgrade</command>
Hole:1 http://security.debian.org lenny/updates Release.gpg [835B]
Ign http://security.debian.org lenny/updates/main Translation-de                
Hole:2 http://volatile.debian.org lenny/volatile Release.gpg [189B]             
Ign http://volatile.debian.org lenny/volatile/main Translation-de               
Hole:3 http://security.debian.org lenny/updates Release [40,8kB]                
Hole:4 http://volatile.debian.org lenny/volatile Release [40,7kB]               
Ign http://security.debian.org lenny/updates/main Packages/DiffIndex            
Ign http://volatile.debian.org lenny/volatile/main Packages/DiffIndex
Ign http://security.debian.org lenny/updates/main Sources/DiffIndex
Ign http://volatile.debian.org lenny/volatile/main Sources/DiffIndex
Hole:5 http://security.debian.org lenny/updates/main Packages [248kB]
Hole:6 http://volatile.debian.org lenny/volatile/main Packages [7488B]          
Hole:7 http://volatile.debian.org lenny/volatile/main Sources [2358B]           
Hole:8 http://security.debian.org lenny/updates/main Sources [66,8kB]           
Treffer http://ftp.de.debian.org lenny Release.gpg                              
Treffer http://ftp.de.debian.org lenny/main Translation-de                      
Treffer http://ftp.de.debian.org lenny Release                                  
Ign http://ftp.de.debian.org lenny/main Packages/DiffIndex                      
Ign http://ftp.de.debian.org lenny/main Sources/DiffIndex                       
Treffer http://ftp.de.debian.org lenny/main Packages                            
Hole:9 http://ftp.de.debian.org lenny/main Sources [2307kB]                     
2714kB wurden in 16s heruntergeladen (163kB/s)                                  
Paketlisten werden gelesen... Fertig

Paketlisten werden gelesen... Fertig
Abhängigkeitsbaum wird aufgebaut       
Lese Status-Informationen ein... Fertig
Lese erweiterte Statusinformationen      
Initialisiere Paketstatus... Fertig
Lese Task-Beschreibungen... Fertig 
Es werden keine Pakete installiert, aktualisiert oder entfernt.
0 Pakete aktualisiert, 0 zusätzlich installiert, 0 werden entfernt und 0 nicht aktualisiert.
Muss 0B an Archiven herunterladen. Nach dem Entpacken werden 0B zusätzlich belegt sein.
Paketlisten werden gelesen... Fertig
Abhängigkeitsbaum wird aufgebaut       
Lese Status-Informationen ein... Fertig
Lese erweiterte Statusinformationen      
Initialisiere Paketstatus... Fertig
Lese Task-Beschreibungen... Fertig 

debian:~# </screen></para>

  <para>Danach bitte einmal booten, um sicher zu stellen, das ein evt. neu
  installieter Kernel auch benutzt wird.<screen>debian:~# <command>shutdown -r now</command>

Broadcast message from root@debian (pts/0) (2009-12-30 19:23:00):

The system is going down for reboot NOW!</screen></para>

  <para>Wir schlagen uns nicht mehr mit der alten 1.8er Ruby-Version rum,
  sondern installieren Ruby 1.9. Und das der Einfachheit halber direkt von der
  Quelle (bitte immer den aktuellen Downloadlink von
  http://www.ruby-lang.org/en/downloads/ übernehmen). Zum
  Kompilieren benötigen Sie eine Buildumgebung. Und wo wir schon mal dabei
  sind, installieren wir direkt noch die Datenbank
  <application>sqlite3</application><footnote>
      <para>Ja, man könnte hier auch eine MySQL oder sonst was Datenbank
      installieren. Brauchen wir aber alles nicht. Die sqlite3 ist für unsere
      Entwicklungsumgebung perfekt geeignet. In der Produktivumgebung kann man
      immer noch auf andere Datenbanken umsteigen.</para>
    </footnote> und den Kommando-Zeilen Web-Browser
  <application>w3m</application>, damit Sie später schneller loslegen
  können.<screen>debian:~# <command>aptitude -y install build-essential libssl-dev zlib1g-dev libreadline5-dev libncurses5-dev sqlite3 libsqlite3-dev curl w3m</command>
Paketlisten werden gelesen... Fertig
Abhängigkeitsbaum wird aufgebaut       
Lese Status-Informationen ein... Fertig
Lese erweiterte Statusinformationen      
Initialisiere Paketstatus... Fertig
Lese Task-Beschreibungen... Fertig 
Die folgenden NEUEN Pakete werden zusätzlich installiert:
  binutils{a} build-essential bzip2{a} ca-certificates{a} cpp{a} cpp-4.3{a} 
  curl dpkg-dev{a} g++{a} g++-4.3{a} gcc{a} gcc-4.3{a} libc6-dev{a} 
  libcurl3{a} libgc1c2{a} libgmp3c2{a} libgomp1{a} libgpm2{a} libidn11{a} 
  libldap-2.4-2{a} libmpfr1ldbl{a} libncurses5-dev libreadline5-dev 
  libsqlite3-0{a} libsqlite3-dev libssh2-1{a} libssl-dev 
  libstdc++6-4.3-dev{a} libtimedate-perl{a} linux-libc-dev{a} make{a} 
  openssl{a} patch{a} sqlite3 w3m zlib1g-dev 
0 Pakete aktualisiert, 36 zusätzlich installiert, 0 werden entfernt und 0 nicht aktualisiert.
Muss 27,3MB an Archiven herunterladen. Nach dem Entpacken werden 82,1MB zusätzlich belegt sein.
Schreibe erweiterte Statusinformationen... Fertig
Hole:1 http://security.debian.org lenny/updates/main libldap-2.4-2 2.4.11-1+lenny1 [189kB]
Hole:2 http://security.debian.org lenny/updates/main linux-libc-dev 2.6.26-19lenny2 [750kB]

[...]

Richte g++-4.3 ein (4.3.2-1.1) ...
Richte g++ ein (4:4.3.2-2) ...
Richte build-essential ein (11.4) ...
Paketlisten werden gelesen... Fertig             
Abhängigkeitsbaum wird aufgebaut       
Lese Status-Informationen ein... Fertig
Lese erweiterte Statusinformationen      
Initialisiere Paketstatus... Fertig
Schreibe erweiterte Statusinformationen... Fertig
Lese Task-Beschreibungen... Fertig               

debian:~#</screen></para>

  <para>Jetzt überprüfen wir noch welche Ruby-Version installiert ist.<screen>debian:~# <command>ruby -v</command>
-bash: ruby: command not found
debian:~#</screen></para>

  <para>A-Ha! Natürlich ist noch keine installiert. Falls bei Ihnen eine
  andere Meldung erscheinen sollte, dann müssen Sie noch mal auf Los zurück
  und ein frisches und diesmal minimales Debian Linux 5.0 installieren.</para>

  <para>Alle anderen: Ein aktuelles (stable) Ruby 1.9 downloaden, entpacken
  und bauen. Je nach Rechenpower Ihres Systems, ist das wahrscheinlich auch
  eine gute Gelegenheit einen Kaffee zu kochen oder mit dem Hund spazieren zu
  gehen.<screen>debian:~# <command>cd /usr/src/</command>
debian:/usr/src# <command>wget ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.1-p376.tar.gz</command>
--2009-12-30 20:45:52--  ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.1-p376.tar.gz
           =&gt; `ruby-1.9.1-p376.tar.gz'
Auflösen des Hostnamen »ftp.ruby-lang.org«.... 221.186.184.68
Verbindungsaufbau zu ftp.ruby-lang.org|221.186.184.68|:21... verbunden.
Anmelden als anonymous ... Angemeldet!
==&gt; SYST ... fertig.    ==&gt; PWD ... fertig.
==&gt; TYPE I ... fertig.  ==&gt; CWD /pub/ruby/1.9 ... fertig.
==&gt; SIZE ruby-1.9.1-p376.tar.gz ... 9073007
==&gt; PASV ... fertig.    ==&gt; RETR ruby-1.9.1-p376.tar.gz ... fertig.
Länge: 9073007 (8,7M)

100%[======================================&gt;] 9.073.007    468K/s   in 24s     

2009-12-30 20:46:25 (367 KB/s) - »ruby-1.9.1-p376.tar.gz« gespeichert [9073007]

debian:/usr/src# <command>tar xzf ruby-1.9.1-p376.tar.gz</command> 
debian:/usr/src# <command>cd ruby-1.9.1-p376</command>
debian:/usr/src/ruby-1.9.1-p376# <command>./configure &amp;&amp; make &amp;&amp; make install</command>
checking build system type... i686-pc-linux-gnu
checking host system type... i686-pc-linux-gnu
checking target system type... i686-pc-linux-gnu
checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables... 
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes

[...]

No definition for sock_s_unpack_sockaddr_un

ext/stringio/stringio.c: Cmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
No definition for rb_io_addstr
m
No definition for rb_io_print
m
No definition for rb_io_printf
mm
No definition for rb_io_puts
mmmmmmmmmmmm
ext/strscan/strscan.c: CCmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
ext/zlib/zlib.c: MCCCCCCCCCCCCCCCCCCmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
Generating RI...

Files:   512
Classes: 1353
Modules: 567
Methods: 7486
Elapsed: 76.6s
./miniruby -I./lib -I.ext/common -I./- -r./ext/purelib.rb  ./instruby.rb --make="make" --dest-dir="" --extout=".ext" --mflags="" --make-flags="" --data-mode=0644 --prog-mode=0755 --installed-list .installed.list --install=rdoc --rdoc-output=".ext/rdoc"
installing rdoc
debian:/usr/src/ruby-1.9.1-p376#</screen></para>

  <para>Kurzer Check, ob Ruby 1.9 auch wirklich installiert wurde.<screen>debian:/usr/src/ruby-1.9.1-p376# <command>cd</command>
debian:~# <command>ruby -v</command>
ruby 1.9.1p376 (2009-12-07 revision 26041) [i686-linux]
debian:~# </screen></para>

  <para>Ja, das sieht sehr gut aus. Jetzt führen wir für den Paketmanager
  <application>gem</application> (der ist ab Ruby 1.9 automatisch mit dabei)
  noch ein Update durch).<screen>debian:~# <command>gem update --system</command>
Updating RubyGems
Updating rubygems-update
Successfully installed rubygems-update-1.3.5
:0:Warning: Gem::SourceIndex#search support for String patterns is deprecated
Updating RubyGems to 1.3.5
Installing RubyGems 1.3.5
RubyGems 1.3.5 installed

=== 1.3.5 / 2009-07-21

Bug fixes:

* Fix use of prerelease gems.
* Gem.bin_path no longer escapes path with spaces. Bug #25935 and #26458.

Deprecation Notices:

* Bulk index update is no longer supported (the code currently remains, but not
  the tests)
* Gem::manage_gems was removed in 1.3.3.
* Time::today was removed in 1.3.3.


------------------------------------------------------------------------------

RubyGems installed the following executables:
 /usr/local/bin/gem

debian:~#</screen></para>

  <para>Vor dem eigentlichen Installation von Rails kümmern wir uns noch darum
  einige andere wichtige Pakete zu installieren.<footnote>
      <para>Ich zeige das hier in Baby-Schritten, weil es sonst Probleme beim
      HTML und PDF Export der Screen-Ausgabe wegen überlangen Zeilen
      gäbe.</para>
    </footnote></para>

  <para><screen>debian:~# <command>gem install tzinfo</command>
Successfully installed tzinfo-0.3.18
1 gem installed
Installing ri documentation for tzinfo-0.3.18...
Updating class cache with 2606 classes...
Installing RDoc documentation for tzinfo-0.3.18...
debian:~# <command>gem install builder</command>
Successfully installed builder-2.1.2
1 gem installed
Installing ri documentation for builder-2.1.2...
Updating class cache with 2655 classes...
Installing RDoc documentation for builder-2.1.2...
debian:~# <command>gem install memcache-client</command>
Successfully installed memcache-client-1.8.1
1 gem installed
Installing ri documentation for memcache-client-1.8.1...
Updating class cache with 2667 classes...
Installing RDoc documentation for memcache-client-1.8.1...
debian:~# <command>gem install rack</command>
Successfully installed rack-1.1.0
1 gem installed
Installing ri documentation for rack-1.1.0...
Updating class cache with 2676 classes...
Installing RDoc documentation for rack-1.1.0...
debian:~# <command>gem install rack-test</command>
Successfully installed rack-test-0.5.3
1 gem installed
Installing ri documentation for rack-test-0.5.3...
Updating class cache with 2681 classes...
Installing RDoc documentation for rack-test-0.5.3...
debian:~# <command>gem install rack-mount</command>
Successfully installed rack-mount-0.6.1
1 gem installed
Installing ri documentation for rack-mount-0.6.1...
Updating class cache with 2692 classes...
Installing RDoc documentation for rack-mount-0.6.1...
debian:~# <command>gem install erubis</command>
Successfully installed abstract-1.0.0
Successfully installed erubis-2.6.5
2 gems installed
Installing ri documentation for abstract-1.0.0...
Installing ri documentation for erubis-2.6.5...
Updating class cache with 2734 classes...
Installing RDoc documentation for abstract-1.0.0...
Installing RDoc documentation for erubis-2.6.5...
debian:~# <command>gem install arel</command>
Successfully installed arel-0.3.3
1 gem installed
Installing ri documentation for arel-0.3.3...
Updating class cache with 2837 classes...
Installing RDoc documentation for arel-0.3.3...
debian:~# <command>gem install mail</command>
Successfully installed mime-types-1.16
Successfully installed polyglot-0.3.1
Successfully installed treetop-1.4.5
Successfully installed mail-2.1.5.3
4 gems installed
Installing ri documentation for mime-types-1.16...
Installing ri documentation for polyglot-0.3.1...
Installing ri documentation for treetop-1.4.5...
Installing ri documentation for mail-2.1.5.3...
Updating class cache with 2948 classes...
Installing RDoc documentation for mime-types-1.16...
Installing RDoc documentation for polyglot-0.3.1...
Installing RDoc documentation for treetop-1.4.5...
Installing RDoc documentation for mail-2.1.5.3...
debian:~# <command>gem install text-format</command>
Successfully installed text-hyphen-1.0.0
Successfully installed text-format-1.0.0
2 gems installed
Installing ri documentation for text-hyphen-1.0.0...
Installing ri documentation for text-format-1.0.0...
Updating class cache with 3337 classes...
Installing RDoc documentation for text-hyphen-1.0.0...
Installing RDoc documentation for text-format-1.0.0...
debian:~# <command>gem install thor</command>
Successfully installed thor-0.13.4
1 gem installed
Installing ri documentation for thor-0.13.4...
Updating class cache with 3346 classes...
Installing RDoc documentation for thor-0.13.4...
debian:~# </screen></para>

  <para>Danach benutzen wir <application>gem</application> zum Installieren
  von Rails. Benötigte andere Pakete werden dabei von
  <application>gem</application> automatisch mit installiert.<important>
      <para>Solange Rails 3.0 nur als Beta-Version zur Verfügung steht, müssen
      Sie diese Version hier mit "--pre" installieren.</para>
    </important><screen>debian:~# <command>gem install rails --pre</command>
Successfully installed bundler-0.9.16
Successfully installed rails-3.0.0.beta2
2 gems installed
Installing ri documentation for bundler-0.9.16...
Installing ri documentation for rails-3.0.0.beta2...
Updating class cache with 3383 classes...
Installing RDoc documentation for bundler-0.9.16...
Installing RDoc documentation for rails-3.0.0.beta2...
debian:~#</screen></para>

  <para>Und bevor wir es vergessen, installieren wir jetzt noch das Ruby-Gem
  um auf die <application>sqlite3</application> Datenbank zugreifen zu
  können.<screen>debian:~# <command>gem install sqlite3-ruby</command>
Building native extensions.  This could take a while...
Successfully installed sqlite3-ruby-1.2.5
1 gem installed
Installing ri documentation for sqlite3-ruby-1.2.5...
Updating class cache with 2543 classes...
Installing RDoc documentation for sqlite3-ruby-1.2.5...
debian:~#</screen></para>

  <para>Das ging doch Ratz-Fatz! Um sicher zu gehen testen wir jetzt noch die
  Versionen:<screen>debian:~# <command>ruby -v</command>
ruby 1.9.1p376 (2009-12-07 revision 26041) [i686-linux]
debian:~# <command>rails -v</command>
Rails 3.0.0.beta2
debian:~#</screen></para>

  <para>Fertig!</para>
</section>
