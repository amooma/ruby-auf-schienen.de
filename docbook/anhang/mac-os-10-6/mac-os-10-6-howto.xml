<?xml version="1.0" encoding="UTF-8"?>
<section version="5.0" xml:id="rails3-install-osx"
         xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:svg="http://www.w3.org/2000/svg"
         xmlns:m="http://www.w3.org/1998/Math/MathML"
         xmlns:html="http://www.w3.org/1999/xhtml"
         xmlns:db="http://docbook.org/ns/docbook">
  <title xml:id="ruby-on-rails-install-howto-mac-os-x.title">Ruby on Rails 3.0
  Installation auf Mac OS 10.6</title>

  <para>Die Anzahl der Ruby on Rails Entwickler die auf Mac OS X entwickeln
  ist erfreulich hoch. Auf Rails-Konferenzen sieht man bei gefühlten 70% der
  Teilnehmer ein MacBook.</para>

  <para>Mac OS 10.6 wird per Default schon mit Ruby und Ruby on Rails
  ausgeliefert. Dummerweise nur mit der Ruby-Version 1.8.7 und mit der
  Rails-Version 2.2.2. Beides für uns uninteressant. Wir wollen ein 1.9.2er
  Ruby und ein 3.0er Rails. Um die bestehende Ruby- und Rails-Installation und
  damit das Paketmanagement von Mac OS X nicht zu beeinflussen, installieren
  wir Ruby 1.9.2 und Rails 3.0 mit rvm (Ruby Version Manager). Infos zu rvm
  finden Sie auf der rvm-Homepage unter
  <uri>http://rvm.beginrescueend.com/</uri></para>

  <para>Mit rvm können Sie im User-Space (also ohne Root-Rechte und in Ihrem
  Home-Verzeichnis) beliebig viele verschiedene Ruby und Rails Versionen
  installieren und laufen lassen. So können Sie parallel an alten Projekten
  die vielleicht noch Ruby 1.8.7 benutzt haben und an neuen Projekte die Ruby
  1.9.2 benutzen arbeiten.</para>

  <section>
    <title>Vorbereitung (Xcode-Update)</title>

    <para>Bevor Sie mit der Ruby on Rails Installation anfangen, müssen Sie
    auf Ihr System die neuesten Xcode Tools von Apple installieren (diese sind
    auf der mitgelieferten Install-DVD fehlerhaft). Das DVD-Image ist gut 750
    MB gross und kann unter folgender URL downgeloadet werden:</para>

    <para><uri>http://developer.apple.com/technology/xcode.html</uri></para>

    <important>
      <para>Zur Installation der Xcode Tools benötigen Sie Admin-Rechte auf
      Ihrem System.</para>
    </important>
  </section>

  <section xml:id="ruby-1.9.2-mit-rvm-macosx">
    <title>Ruby 1.9.2 mit rvm installieren</title>

    <para>Öffnen Sie bitte mit Ihren normalen User-Rechten ein Terminal und
    überprüfen Sie die installierte Ruby-Version:<screen>MacBook:~ xyz$ <command>ruby -v</command>
ruby 1.8.7 (2009-06-12 patchlevel 174) [universal-darwin10.0]
MacBook:~ xyz$ </screen></para>

    <para>rvm lässt sich auf verschiedene Wege installieren. Ich empfehle das
    nun folgende Monsterkommando, weil damit das aktuellste stabile rvm
    installiert wird:<screen>MacBook:~ xyz$ <command>bash &lt; &lt;( curl http://rvm.beginrescueend.com/releases/rvm-install-head )</command>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
121   364  121   364    0     0    922      0 --:--:-- --:--:-- --:--:--  1967
Initialized empty Git repository in /Users/xyz/.rvm/src/rvm/.git/
remote: Counting objects: 13224, done.
remote: Compressing objects: 100% (3246/3246), done.
remote: Total 13224 (delta 8709), reused 13116 (delta 8638)
Receiving objects: 100% (13224/13224), 2.34 MiB | 212 KiB/s, done.
Resolving deltas: 100% (8709/8709), done.

RVM:   shell scripts which allow management of multiple ruby interpreters and environments.
RTFM:  http://rvm.beginrescueend.com/
HELP:  http://webchat.freenode.net/?channels=rvm (#rvm on irc.freenode.net)

* Installing rvm to /Users/xyz/.rvm/
    Correct permissions for base binaries in /Users/xyz/.rvm/bin...
    Copying manpages into place.
Notes for Darwin ( Mac OS X ) 

    *  For Snow Leopard be sure to have XCode Tools Version 3.2.1 (1613) or later (there were bugs with the dvd release version).
    *  You should download the latest XCode tools from developer.apple.com. This is necessary since the dvd install for Snow Leopard has bugs.
    *  If you intend on installing MacRuby you must install LLVM first.
    *  If you intend on installing JRuby you must install the JDK.
    *  If you intend on installing IronRuby you must install Mono (version 2.6 or greater is recommended).


xyz,

Thank you for using rvm. I hope that it makes your work easier and more enjoyable.
If you have any questions, issues and/or ideas for improvement please hop in #rvm on irc.freenode.net and let me know.
My irc nickname is 'wayneeseguin' and I hang out from ~09:00-17:00EST and again from ~21:00EST-~00:00EST.
If I do not respond right away, please hang around after asking your question, I will respond as soon as I am back.
Be sure to get head often as rvm development happens fast, you can do this by running 'rvm update --head'.
  w⦿‿⦿t!
    ~ Wayne

You must now finish the install manually:
1) Place the folowing line at the end of your shell's loading files(.bashrc or .bash_profile for bash and .zshrc for zsh), after all path/variable settings:
     [[ -s $HOME/.rvm/scripts/rvm ]] &amp;&amp; source $HOME/.rvm/scripts/rvm
   Please note that this must only occur once - so, you only need to add it the first time you install rvm.
2) Ensure that there is no 'return' from inside the .bashrc file. (otherwise rvm will be prevented from working properly).
   This means that if you see '[ -z "$PS1" ] &amp;&amp; return' then you must change this line to:
   if [[ -n "$PS1" ]] ; then
     ... original content that was below the &amp;&amp; return line ...
   fi # &lt;= be sure to close the if.
   #EOF .bashrc
   Be absolutely *sure* to REMOVE the '&amp;&amp; return'.
   If you wish to DRY up your config you can 'source ~/.bashrc' at the bottom of your .bash_profile.
   placing all non-interactive items in the .bashrc, including the 'source' line above
3) Then CLOSE THIS SHELL and open a new one in order to use rvm.

Installation of RVM to /Users/xyz/.rvm/ is complete.

MacBook:~ xyz$ 
</screen></para>

    <note>
      <para>Das obige Kommando zieht rvm per git. Das ist schnell, aber
      funktioniert nicht hinter jeder Firewall. Sollten Sie hinter einer
      solchen Firewall sitzen, dann müssen Sie <uri
      xlink:href="http://rvm.beginrescueend.com/releases/rvm-install-head">http://rvm.beginrescueend.com/releases/rvm-install-head</uri>
      von Hand downloaden und mit einem Editor alle git:// URIs auf http://
      ändern. Danach normal als Shell-Script starten.</para>
    </note>

    <para>rvm ist fertig installiert, aber Sie müssen zum täglichen Gebrauch
    noch die entsprechende Zeile in Ihre <filename>.bash_profile</filename>
    einfügen. Mit <command>ls -la .bash_profile</command> können Sie
    überprüfen, ob diese Datei bereits existiert:<screen>MacBook:~ xyz$ <command>ls -la .bash_profile</command>
ls: .bash_profile: No such file or directory
MacBook:~ xyz$</screen></para>

    <para>Falls wie in diesem Fall die Datei noch nicht existiert, können Sie
    Sie mit <command>touch .bash_profile</command> erstellen.<screen>MacBook:~ sw$ <command>touch .bash_profile</command>
MacBook:~ sw$</screen></para>

    <note>
      <para>Falls Sie eine andere Shell als die Bash-Shell benutzen, müssen
      Sie in der dann entsprechenden Datei diese Veränderung vornehmen. Bitte
      lesen Sie dazu die Ausgabe des rvm Installers.</para>
    </note>

    <para>Die Veränderung in der <filename>.bash_profile</filename> bitte mit
    folgender Zeile einfügen:<screen>MacBook:~ sw$ <command>echo '[[ -s $HOME/.rvm/scripts/rvm ]] &amp;&amp; source $HOME/.rvm/scripts/rvm' &gt;&gt; .bash_profile</command> 
MacBook:~ sw$</screen></para>

    <important>
      <para>Jetzt müssen Sie das Terminal schliessen und ein neues Terminal
      aufmachen (an sonsten wirkt die Veränderung von eben nicht).</para>
    </important>

    <para>Zum Testen, ob <application>rvm</application> richtig installiert
    ist, rufen wir es einmal mit <parameter>-v</parameter> auf.<screen>MacBook:~ xyz$ <command>rvm -v</command>

rvm 1.0.1 by Wayne E. Seguin (wayneeseguin@gmail.com) [http://rvm.beginrescueend.com/]

MacBook:~ xyz$</screen></para>

    <para>Sollte hierbei als Antwort der Bash ein "command not found"
    ausgegeben worden sein, müssen Sie die obigen Schritte noch einmal
    überprüfen. Wahrscheinlich haben Sie einen Schritt ausgelassen.</para>

    <para>Mit <application>rvm</application> können Sie im neuen Terminal Ruby
    1.9.2 installieren:<screen>MacBook:~ xyz$ <command>rvm install ruby-1.9.2</command>

info: Installing Ruby from source to: /Users/xyz/.rvm/rubies/ruby-1.9.2-p0

info: Downloading ruby-1.9.2-p0, this may take a while depending on your connection...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 8296k  100 8296k    0     0  61062      0  0:02:19  0:02:19 --:--:-- 40501

info: Extracting ruby-1.9.2-p0 ...

info: Configuring ruby-1.9.2-p0, this may take a while depending on your cpu(s)...

info: Compiling ruby-1.9.2-p0, this may take a while depending on your cpu(s)...

info: Installing ruby-1.9.2-p0

info: Installation of ruby-1.9.2-p0 is complete.

info: Updating rubygems for /Users/xyz/.rvm/gems/ruby-1.9.2-p0@global

info: Updating rubygems for /Users/xyz/.rvm/gems/ruby-1.9.2-p0

info: adjusting shebangs for ruby-1.9.2-p0 (gem irb erb ri rdoc testrb rake).

info: Importing initial gems...
MacBook:~ xyz$</screen></para>

    <para>Noch werden Sie per Default ein 1.8er Ruby aufrufen. Das lässt sich
    leicht mit <application>ruby -v</application> rausfinden.<screen>MacBook:~ xyz$ <command>ruby -v</command>
ruby 1.8.7 (2009-06-12 patchlevel 174) [universal-darwin10.0]
MacBook:~ xyz$ </screen></para>

    <para>Mit dem Befehl <command>rvm 1.9.2</command> können Sie aber auf ein
    1.9.2er Ruby wechseln.<screen>MacBook:~ xyz$ <command>rvm 1.9.2</command>
MacBook:~ xyz$ <command>ruby -v</command>
ruby 1.9.2p0 (2010-08-18 revision 29036) [x86_64-darwin10.4.0]
MacBook:~ xyz$</screen></para>

    <para>Um das nicht bei jedem Einloggen neu eingeben zu müssen, können Sie
    Ruby 1.9.2 auch als Default einstellen:</para>

    <para><screen>MacBook:~ xyz$ <command>rvm --default 1.9.2</command>
MacBook:~ xyz$</screen></para>

    <para>Jetzt haben wir auf unserem Mac OS X 10.6 System mit rvm ein
    aktuelles Ruby 1.9.2 installiert und können mit dem Programm rvm zwischen
    den beiden Versionen hin und her schalten. Für den Rest des Buches gehe
    ich immer von einer 1.9.2 Version aus.</para>

    <note>
      <para>Mit <command>rvm system</command> können Sie auch jederzeit wieder
      auf die System-Ruby Version 1.8.x. Geben Sie einfach
      <command>rvm</command> ein, um eine entsprechende Hilfe-Seite angezeigt
      zu bekommen.</para>
    </note>
  </section>

  <section xml:id="rails3-gem-install-macosx">
    <title>Rails 3.0 installieren</title>

    <para>Zu erst überprüfen wir, ob ein Ruby in der Version 1.9.2 aufgerufen
    wird. Falls dies nicht der Fall sein sollte, lesen Sie sich bitte <xref
    linkend="ruby-1.9.2-mit-rvm-macosx" /> durch.<screen>MacBook:~ xyz$ <command>ruby -v</command>
ruby 1.9.2p0 (2010-08-18 revision 29036) [x86_64-darwin10.4.0]
MacBook:~ xyz$</screen></para>

    <para>Als nächstes stellen wir sicher, das der Paketmanagers gem aktuell
    ist:<screen>MacBook:~ xyz$ <command>gem update --system</command>
Updating RubyGems
Nothing to update
MacBook:~ xyz$ <command>gem update</command>
Updating installed gems
Updating bundler
Successfully installed bundler-1.0.0
Gems updated: bundler
Installing ri documentation for bundler-1.0.0...
Installing RDoc documentation for bundler-1.0.0...
MacBook:~ xyz$</screen></para>

    <para>Der Rest ist einfach:<screen>MacBook:~ xyz$ <command>gem install rails --version 3.0.0</command>
Successfully installed railties-3.0.0
Successfully installed rails-3.0.0
2 gems installed
Installing ri documentation for railties-3.0.0...
Installing ri documentation for rails-3.0.0...
Installing RDoc documentation for railties-3.0.0...
Installing RDoc documentation for rails-3.0.0...
MacBook:~ xyz$</screen></para>

    <para>Perfekt. Jetzt haben Sie Rails 3.0 installiert. <screen>MacBook:~ xyz$ <command>rails -v</command>
Rails 3.0.0
MacBook:~ xyz$</screen></para>
  </section>

  <section>
    <title>Und jetzt?</title>

    <para>Wenn Sie noch nie mit Ruby gearbeitet haben, sollten Sie als
    nächstes <xref linkend="ruby-grundlagen" /> lesen. Wenn Sie schon
    Ruby-Meister sind und sich neu mit Rails beschäftigen wollen, dann
    empfehle ich Ihnen die Lektüre von <xref
    linkend="erste_schritte_mit_rails" />.</para>
  </section>
</section>
