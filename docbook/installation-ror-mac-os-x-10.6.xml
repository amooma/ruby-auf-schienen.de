<?xml version="1.0" encoding="UTF-8"?>
<section version="5.0" xml:id="rails3-install-osx" xml:lang="de"
         xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:svg="http://www.w3.org/2000/svg"
         xmlns:m="http://www.w3.org/1998/Math/MathML"
         xmlns:html="http://www.w3.org/1999/xhtml"
         xmlns:db="http://docbook.org/ns/docbook">
  <title xml:id="rails3-install-osx.title">Installation von Ruby on Rails 3.0
  mit RVM auf Mac OS X 10.6</title>

  <info>
    <collab>
      <person>
        <personname><firstname>Philipp</firstname><surname>Kempgen</surname></personname>
      </person>
    </collab>
  </info>

  <indexterm>
    <primary>Installation</primary>

    <secondary>von Ruby on Rails</secondary>

    <tertiary>auf Mac OS X 10.6</tertiary>
  </indexterm>

  <indexterm>
    <primary>Mac OS X 10.6</primary>

    <secondary>Installation von Ruby on Rails</secondary>
  </indexterm>

  <indexterm>
    <primary>Ruby</primary>

    <secondary>Installation</secondary>
  </indexterm>

  <indexterm>
    <primary>Rails</primary>

    <secondary>Installation</secondary>
  </indexterm>

  <indexterm>
    <primary>RVM (Ruby Version Manager)</primary>
  </indexterm>

  <indexterm>
    <primary>Ruby Version Manager</primary>

    <see>RVM</see>
  </indexterm>

  <para>Die Anzahl der Ruby-on-Rails-Entwickler die auf Mac OS X entwickeln
  ist erfreulich hoch. Auf Rails-Konferenzen sieht man bei gefühlten 70 % der
  Teilnehmer ein MacBook.</para>

  <para>Mac OS 10.6 wird standardmäßig schon mit Ruby und Ruby on Rails
  ausgeliefert. Dummerweise nur mit der Ruby-Version 1.8.7 und mit der
  Rails-Version 2.3.5. Beides ist für uns uninteressant. Wir wollen ein
  1.9.2er Ruby und ein 3.0er Rails. Um die bestehende Ruby- und
  Rails-Installation und damit das Paketmanagement von Mac OS X nicht zu
  beeinflussen, installieren wir Ruby 1.9.2 und Rails 3.0 mit <indexterm>
      <primary>RVM</primary>
    </indexterm><indexterm>
      <primary>Ruby Version Manager</primary>
    </indexterm>RVM (Ruby Version Manager).</para>

  <para>Mit RVM können Sie als normaler Benutzer (also ohne Root-Rechte und in
  Ihrem Home-Verzeichnis) beliebig viele verschiedene Ruby-
  und-Rails-Versionen installieren und laufen lassen. So können Sie parallel
  an alten Projekten die vielleicht noch Ruby 1.8.7 benutzen und an neuen
  Projekten die Ruby 1.9.2 benutzen arbeiten.</para>

  <note>
    <para>Detaillierte Infos zu RVM finden Sie auf der RVM-Homepage unter <uri
    xlink:href="http://rvm.beginrescueend.com/">http://rvm.beginrescueend.com/</uri>.</para>
  </note>

  <section xml:id="xcode-install">
    <title xml:id="xcode-install.title">Xcode-Installation bzw.
    -Upgrade</title>

    <indexterm>
      <primary>Xcode</primary>
    </indexterm>

    <para>Bevor Sie mit der Installation von Ruby on Rails anfangen müssen Sie
    auf Ihrem System die <emphasis>neuesten</emphasis> Xcode-Tools von Apple
    installieren. Das DVD-Image ist gut 750 MB groß und kann unter folgender
    URL heruntergeladen werden:</para>

    <para><uri
    xlink:href="http://developer.apple.com/technology/xcode.html">http://developer.apple.com/technology/xcode.html</uri></para>

    <important>
      <para>Zur Installation von Xcode benötigen Sie Admin-Rechte auf Ihrem
      System.</para>
    </important>
  </section>

  <section xml:id="ruby-1.9.2-mit-rvm-macosx">
    <title xml:id="ruby-1.9.2-mit-rvm-macosx.title">Ruby 1.9.2 mit RVM
    installieren</title>

    <para>Öffnen Sie bitte mit Ihren normalen User-Rechten ein Terminal und
    überprüfen Sie die installierte Ruby-Version:<screen>MacBook:~ xyz$ <command>ruby -v</command>
ruby 1.8.7 (2009-06-12 patchlevel 174) [universal-darwin10.0]</screen></para>

    <para>RVM lässt sich auf verschiedene Wege installieren. Ich empfehle das
    folgende Monsterkommando (bitte exakt kopieren), mit dem das aktuellste
    RVM installiert wird:<screen>MacBook:~ xyz$ <command>bash &lt; &lt;( curl http://rvm.beginrescueend.com/releases/rvm-install-head )</command>

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
121   364  121   364    0     0    922      0 --:--:-- --:--:-- --:--:--  1967

Initialized empty Git repository in /Users/xyz/.rvm/src/rvm/.git/
remote: Counting objects: 13224, done.
remote: Compressing objects: 100% (3246/3246), done.
remote: Total 13224 (delta 8709), reused 13116 (delta 8638)
Receiving objects: 100% (13224/13224), 2.34 MiB | 212 KiB/s, done.
Resolving deltas: 100% (8709/8709), done.

RVM:   shell scripts which allow management of multiple ruby interpreters and environments.
RTFM:  http://rvm.beginrescueend.com/
HELP:  http://webchat.freenode.net/?channels=rvm (#rvm on irc.freenode.net)

* Installing rvm to /Users/xyz/.rvm/
    Correct permissions for base binaries in /Users/xyz/.rvm/bin...
    Copying manpages into place.

Notes for Darwin ( Mac OS X ) 

    *  For Snow Leopard be sure to have XCode Tools Version 3.2.1 (1613) or later (there were bugs with the dvd release version).
    *  You should download the latest XCode tools from developer.apple.com. This is necessary since the dvd install for Snow Leopard has bugs.
    *  If you intend on installing MacRuby you must install LLVM first.
    *  If you intend on installing JRuby you must install the JDK.
    *  If you intend on installing IronRuby you must install Mono (version 2.6 or greater is recommended).


xyz,

Thank you for using rvm. I hope that it makes your work easier and more enjoyable.
If you have any questions, issues and/or ideas for improvement please hop in #rvm on irc.freenode.net and let me know.
My irc nickname is 'wayneeseguin' and I hang out from ~09:00-17:00EST and again from ~21:00EST-~00:00EST.
If I do not respond right away, please hang around after asking your question, I will respond as soon as I am back.
Be sure to get head often as rvm development happens fast, you can do this by running 'rvm update --head'.
  w⦿‿⦿t!
    ~ Wayne

You must now finish the install manually:
1) Place the folowing line at the end of your shell's loading files(.bashrc or .bash_profile for bash and .zshrc for zsh), after all path/variable settings:
     [[ -s $HOME/.rvm/scripts/rvm ]] &amp;&amp; source $HOME/.rvm/scripts/rvm
   Please note that this must only occur once - so, you only need to add it the first time you install rvm.
2) Ensure that there is no 'return' from inside the .bashrc file. (otherwise rvm will be prevented from working properly).
   This means that if you see '[ -z "$PS1" ] &amp;&amp; return' then you must change this line to:
   if [[ -n "$PS1" ]] ; then
     ... original content that was below the &amp;&amp; return line ...
   fi # &lt;= be sure to close the if.
   #EOF .bashrc
   Be absolutely *sure* to REMOVE the '&amp;&amp; return'.
   If you wish to DRY up your config you can 'source ~/.bashrc' at the bottom of your .bash_profile.
   placing all non-interactive items in the .bashrc, including the 'source' line above
3) Then CLOSE THIS SHELL and open a new one in order to use rvm.

Installation of RVM to /Users/xyz/.rvm/ is complete.
</screen></para>

    <note>
      <para>Das obige Kommando zieht RVM per Git. Das ist schnell,
      funktioniert aber nicht hinter jeder Firewall. Sollten Sie hinter einer
      solchen Firewall sitzen, dann müssen Sie <uri
      xlink:href="http://rvm.beginrescueend.com/releases/rvm-install-head">http://rvm.beginrescueend.com/releases/rvm-install-head</uri>
      von Hand herunterladen und darin mit einem Editor alle
      <literal>git://</literal>-URIs auf <literal>http://</literal> ändern.
      Danach normal als Shell-Script aufrufen.</para>
    </note>

    <para>RVM ist jetzt fertig installiert, aber Sie müssen zum täglichen
    Gebrauch noch das Setzen einiger Grundparameter beim Starten einer neuen
    Shell in Ihre <filename>.bash_profile</filename> einfügen: <note>
        <para>Falls Sie eine andere Shell als die Bash-Shell benutzen, müssen
        Sie in der dann entsprechenden Datei diese Veränderung vornehmen.
        Bitte lesen Sie dazu die Ausgabe des RVM-Installers.</para>
      </note></para>

    <para><screen>MacBook:~ xyz$ <command>echo '[[ -s $HOME/.rvm/scripts/rvm ]] &amp;&amp; source $HOME/.rvm/scripts/rvm' &gt;&gt; .bash_profile</command>
</screen></para>

    <important>
      <para>Jetzt müssen Sie das Terminal schließen und ein neues Terminal
      öffnen, denn ansonsten wirkt die Veränderung von eben noch nicht.</para>
    </important>

    <para>Zum Testen ob <literal>rvm</literal> richtig installiert ist rufen
    wir es einmal mit <literal>-v</literal> auf:<screen>MacBook:~ xyz$ <command>rvm -v</command>

rvm 1.0.1 by Wayne E. Seguin (wayneeseguin@gmail.com) [http://rvm.beginrescueend.com/]</screen></para>

    <para>Sollte hierbei als Antwort der Bash <quote><literal>command not
    found</literal></quote> ausgegeben worden sein, müssen Sie die obigen
    Schritte noch einmal überprüfen. Wahrscheinlich haben Sie einen Schritt
    ausgelassen.</para>

    <para>Der folgende Befehl zeigt Ihnen die <quote>Rubies</quote>
    (Ruby-Interpreter) an die RVM kennt <footnote>
        <para>siehe <uri
        xlink:href="http://rvm.beginrescueend.com/rubies/list/"
        xml:lang="en">http://rvm.beginrescueend.com/rubies/list/</uri></para>
      </footnote>:<screen>MacBook:~ xyz$ <command>rvm list known</command>
# MRI Rubies
[ruby-]1.8.6[-p399]
[ruby-]1.8.6-head
[ruby-]1.8.7[-p302]
[ruby-]1.8.7-head
[ruby-]1.9.1-p243
[ruby-]1.9.1[-p376]
[ruby-]1.9.1-p429
[ruby-]1.9.1-head
[ruby-]1.9.2-preview1
[ruby-]1.9.2-preview3
[ruby-]1.9.2-rc1
[ruby-]1.9.2-rc2
[ruby-]1.9.2[-p0]
[ruby-]1.9.2-head
ruby-head
<replaceable>[...]</replaceable></screen></para>

    <note>
      <para><indexterm>
          <primary>Interpreter</primary>

          <secondary>Ruby</secondary>
        </indexterm><indexterm>
          <primary>Ruby</primary>

          <secondary>Interpreter</secondary>
        </indexterm>Es gibt für Ruby verschiedene Interpreter. Relevant ist
      für uns hier der ganz normale <indexterm>
          <primary>MRI (Matz's Ruby Interpreter)</primary>
        </indexterm><indexterm>
          <primary>Matz's Ruby Interpreter</primary>

          <see>MRI</see>
        </indexterm><emphasis role="bold"><acronym>MRI</acronym></emphasis>
      (<foreignphrase xml:lang="en">Matz's Ruby Interpreter</foreignphrase>)
      <footnote>
          <para>siehe <uri
          xlink:href="http://de.wikipedia.org/wiki/Ruby_%28Programmiersprache%29#Implementierungen">http://de.wikipedia.org/wiki/Ruby_(Programmiersprache)#Implementierungen</uri>,
          <uri xlink:href="http://en.wikipedia.org/wiki/Ruby_MRI"
          xml:lang="en">http://en.wikipedia.org/wiki/Ruby_MRI</uri></para>
        </footnote>, dessen Kern seit Ruby 1.9 die Ruby-VM namens <indexterm>
          <primary>YARV (Yet Another Ruby VM)</primary>
        </indexterm><emphasis role="bold"><acronym>YARV</acronym></emphasis>
      (<foreignphrase xml:lang="en">Yet Another Ruby VM</foreignphrase>)
      <footnote>
          <para>siehe <uri xlink:href="http://en.wikipedia.org/wiki/YARV"
          xml:lang="en">http://en.wikipedia.org/wiki/YARV</uri></para>
        </footnote> bildet.</para>
    </note>

    <para>Jetzt können wir im neuen Terminal mit RVM Ruby 1.9.2
    installieren:<screen>MacBook:~ xyz$ <command>rvm install ruby-1.9.2</command>

info: Installing Ruby from source to: /Users/xyz/.rvm/rubies/ruby-1.9.2-p0

info: Downloading ruby-1.9.2-p0, this may take a while depending on your connection...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 8296k  100 8296k    0     0  61062      0  0:02:19  0:02:19 --:--:-- 40501

info: Extracting ruby-1.9.2-p0 ...
info: Configuring ruby-1.9.2-p0, this may take a while depending on your cpu(s)...
info: Compiling ruby-1.9.2-p0, this may take a while depending on your cpu(s)...
info: Installing ruby-1.9.2-p0
info: Installation of ruby-1.9.2-p0 is complete.
info: Updating rubygems for /Users/xyz/.rvm/gems/ruby-1.9.2-p0@global
info: Updating rubygems for /Users/xyz/.rvm/gems/ruby-1.9.2-p0
info: adjusting shebangs for ruby-1.9.2-p0 (gem irb erb ri rdoc testrb rake).
info: Importing initial gems...
MacBook:~ xyz$ </screen></para>

    <para>Noch werden Sie per Default das auf OS X mitgelieferte 1.8er Ruby
    aufrufen. Das lässt sich leicht mit <command>ruby -v</command>
    rausfinden.<screen>MacBook:~ xyz$ <command>ruby -v</command>
ruby 1.8.7 (2009-06-12 patchlevel 174) [universal-darwin10.0]</screen></para>

    <para>Mit dem Befehl <command>rvm 1.9.2</command> können Sie aber auf ein
    1.9.2er Ruby wechseln.<screen>MacBook:~ xyz$ <command>rvm 1.9.2</command>
MacBook:~ xyz$ <command>ruby -v</command>
ruby 1.9.2p0 (2010-08-18 revision 29036) [x86_64-darwin10.4.0]</screen></para>

    <para>Um das nicht bei jedem Einloggen neu eingeben zu müssen, können Sie
    Ruby 1.9.2 auch als Default einstellen:</para>

    <para><screen>MacBook:~ xyz$ <command>rvm --default 1.9.2</command></screen></para>

    <para>Jetzt haben wir auf unserem Mac OS X 10.6 mit
    <application>rvm</application> ein aktuelles Ruby 1.9.2 installiert und
    können mit dem Programm <literal>rvm</literal> zwischen den beiden
    Versionen hin- und herschalten. Für den Rest des Buches gehe ich immer von
    der Version 1.9.2 aus.</para>

    <note>
      <para>Mit dem Befehl <command>rvm system</command> können Sie auch
      jederzeit wieder auf die System-Ruby-Version 1.8.x
      zurückschalten.</para>
    </note>

    <tip>
      <para>Geben Sie einfach mal den Befehl <command>rvm</command> ein, um
      eine entsprechende Hilfe-Seite mit weiteren Befehlen angezeigt zu
      bekommen.</para>
    </tip>
  </section>

  <section xml:id="rails3-gem-install-macosx">
    <title xml:id="rails3-gem-install-macosx.title">Rails 3.0
    installieren</title>

    <para>Zuerst überprüfen wir, ob ein Ruby in der Version 1.9.2 aufgerufen
    wird. Falls dies nicht der Fall sein sollte, lesen Sie sich bitte <xref
    linkend="ruby-1.9.2-mit-rvm-macosx" /> durch.<screen>MacBook:~ xyz$ <command>ruby -v</command>
ruby 1.9.2p0 (2010-08-18 revision 29036) [x86_64-darwin10.4.0]</screen></para>

    <para>Als nächstes stellen wir sicher, dass das
    <application>gem</application>-Paketmanagement aktuell ist:<screen>MacBook:~ xyz$ <command>gem update --system</command>
Updating RubyGems
Nothing to update

MacBook:~ xyz$ <command>gem update</command>
Updating installed gems
Updating bundler
Successfully installed bundler-1.0.0
Gems updated: bundler
Installing ri documentation for bundler-1.0.0...
Installing RDoc documentation for bundler-1.0.0...</screen></para>

    <para>Der Rest ist einfach:<screen>MacBook:~ xyz$ <command>gem install rails --version 3.0.0</command>
Successfully installed railties-3.0.0
Successfully installed rails-3.0.0
2 gems installed
Installing ri documentation for railties-3.0.0...
Installing ri documentation for rails-3.0.0...
Installing RDoc documentation for railties-3.0.0...
Installing RDoc documentation for rails-3.0.0...</screen></para>

    <para>Perfekt. Jetzt haben Sie Rails 3.0 installiert. <screen>MacBook:~ xyz$ <command>rails -v</command>
Rails 3.0.0</screen></para>
  </section>

  <section>
    <title xml:id="macosx-install-danach">Und jetzt?</title>

    <para>Wenn Sie noch nie mit Ruby gearbeitet haben, sollten Sie als
    nächstes <xref linkend="ruby-grundlagen" /> lesen. Wenn Sie schon
    Ruby-Meister sind und sich neu mit Rails beschäftigen wollen, dann
    empfehle ich Ihnen die Lektüre von <xref
    linkend="erste_schritte_mit_rails" />.</para>
  </section>
</section>
